// ==UserScript==
// @name                WME Homestead Sectors
// @namespace           https://greasyfork.org/en/users/5920-rickzabel
// @description         Creates polygons for Homestead Sectors
// @include             https://www.waze.com/editor/*
// @include             https://www.waze.com/*/editor/*
// @include             https://editor-beta.waze.com/*
// @version             1.9 HR0.1
// @grant               none
// @copyright           2015 rickzabel based off work by 2014 davielde
// ==/UserScript==


//---------------------------------------------------------------------------------------


//generated by rickzabel's overlay generator
//special thanks to t0cableguy for helping with the census data


//RZ RaidName will be replaced by the name of the layer in your KML file
//RZ RaidNameNoSpaces will be replaced by the name of the layer in your KML file
//RZ AreaPoints will be replaced by the names, colors, and area points from your KML file



function bootstrap_MapRaidOverlay()
{
  var bGreasemonkeyServiceDefined = false;

  try {
    bGreasemonkeyServiceDefined = (typeof Components.interfaces.gmIGreasemonkeyService === "object");
  }
  catch (err) { /* Ignore */ }

  if (typeof unsafeWindow === "undefined" || ! bGreasemonkeyServiceDefined) {
    unsafeWindow    = ( function () {
      var dummyElem = document.createElement('p');
      dummyElem.setAttribute('onclick', 'return window;');
      return dummyElem.onclick();
    }) ();
  }

    /* begin running the code! */
    setTimeout(InitMapRaidOverlay, 1000);
}

function AddRaidPolygon(raidLayer,groupPoints,groupColor,groupNumber){
    
    var mro_Map = unsafeWindow.Waze.map;
    var mro_OL = unsafeWindow.OpenLayers;
    var raidGroupLabel = groupNumber;
    var groupName = groupNumber;
    
    var style = {
        strokeColor: "Orange",
        strokeOpacity: .9,
        strokeWidth: 5,
        fillColor: groupColor,
        fillOpacity: 0.05,
        label: raidGroupLabel,
        labelOutlineColor: "Black",
        labelOutlineWidth: 3,
        fontSize: 14,
        fontColor: "Pink",
        fontOpacity: .85,
        fontWeight: "bold"  
    };
	
    var attributes = {
        name: groupName,
        number: groupNumber,
		holes: "false"
	};
    
    var pnt= [];
    for(i=0;i<groupPoints.length;i++){
        convPoint = new OpenLayers.Geometry.Point(groupPoints[i].lon,groupPoints[i].lat).transform(new OpenLayers.Projection("EPSG:4326"), mro_Map.getProjectionObject());
        //console.log('MapRaid: ' + JSON.stringify(groupPoints[i]) + ', ' + groupPoints[i].lon + ', ' + groupPoints[i].lat);
        pnt.push(convPoint);
    }
		       
    var ring = new mro_OL.Geometry.LinearRing(pnt);
    var polygon = new mro_OL.Geometry.Polygon([ring]);
    
    var feature = new mro_OL.Feature.Vector(polygon,attributes,style);
    raidLayer.addFeatures([feature]);

}

function generateholes(mro_Map, raid_mapLayer, UntitledPolygon){
	var mro_mapLayers = mro_Map.getLayersBy("uniqueName","__Florida");
	var raid_mapLayerLength = raid_mapLayer.features.length;	
	
	var style = raid_mapLayer.features[raid_mapLayerLength-2].style;
	var attributes = raid_mapLayer.features[raid_mapLayerLength-2].attributes;
	
	//console.dir(style);	
	//console.dir(attributes);	
	
	var newFeature = Subtract(raid_mapLayer.features[raid_mapLayerLength-2], raid_mapLayer.features[1]);
    
	//console.dir(raid_mapLayer);	
	
	raid_mapLayer.addFeatures([newFeature]);

    raid_mapLayer.features[raid_mapLayerLength-1].destroy();
	raid_mapLayer.features[raid_mapLayerLength-2].destroy();
		
	//console.dir(mro_mapLayers);	
	var mro_mapLayersFeaturesLength = mro_mapLayers[0].features.length;
    mro_mapLayers[0].features[mro_mapLayersFeaturesLength-1].style =  style;
	mro_mapLayers[0].features[mro_mapLayersFeaturesLength-1].attributes = attributes;
    mro_mapLayers[0].features[mro_mapLayersFeaturesLength-1].attributes.holes = "true";
	//raid_mapLayer.features[1].style = {label: "Updated label"};
    mro_mapLayers[0].redraw(); 
	
	//console.dir(raid_mapLayer);	
}

function Subtract(bigFeature, smallFeature) {

    var newPolygon = new OpenLayers.Geometry.Polygon(bigFeature.geometry.components);
    var newFeature = new OpenLayers.Feature.Vector(newPolygon);

    newPolygon.addComponent(smallFeature.geometry.components[0]);

    return newFeature;
}

function CurrentRaidLocation(raid_mapLayer){
    var mro_Map = unsafeWindow.Waze.map;

    for(i=0;i<raid_mapLayer.features.length;i++){
        var raidMapCenter = mro_Map.getCenter();
        var raidCenterPoint = new OpenLayers.Geometry.Point(raidMapCenter.lon,raidMapCenter.lat);
        var raidCenterCheck = raid_mapLayer.features[i].geometry.components[0].containsPoint(raidCenterPoint);
		var holes = raid_mapLayer.features[i].attributes.holes
		
        
        if(raidCenterCheck === true){
			
			//console.log('MapRaid: ' + i + " " + raid_mapLayer.features[i].attributes.number + ': ' + raidCenterCheck + ' holes: ' + holes );
			
        	var raidLocationLabel = 'County - ' + raid_mapLayer.features[i].attributes.number + ' - ' + $('.WazeControlLocationInfo').text();
    		//setTimeout(function(){$('.WazeControlLocationInfo').text(raidLocationLabel);},200);
			setTimeout(function(){$('.WazeControlLocationInfo').text(raidLocationLabel);},50);
			var str = $('.WazeControlLocationInfo').text();
			
			var n2 = str.indexOf(" - ");
			
			if(n2 > 0){
				var n = str.length;
				var res = str.substring(n2+2, n);
				var rescount = res.indexOf(" - ");
				if(rescount>0){
					var n3 = res.length;
					var res2 = res.substring(rescount+2, n3);
						
				}
				var raidLocationLabel = 'Sector ' + raid_mapLayer.features[i].attributes.number + ' - ' + res2;
			} else {
				var raidLocationLabel = 'Sector ' + raid_mapLayer.features[i].attributes.number + ' - ' + $('.WazeControlLocationInfo').text();
			}	
    		setTimeout(function(){$('.WazeControlLocationInfo').text(raidLocationLabel);},200);
			 if (holes === "false") { break; }
		}
    }
}


function InitMapRaidOverlay(){

    var mro_Map = unsafeWindow.Waze.map;
    var mro_OL = unsafeWindow.OpenLayers;

    //if (!mro_Map) return;
    //if (!mro_OL) return;

    var mro_mapLayers = mro_Map.getLayersBy("uniqueName","__Florida");
        
    var raid_mapLayer = new mro_OL.Layer.Vector("Homestead Sectors", {
        displayInLayerSwitcher: true,
        uniqueName: "__Florida"
    });
        
    I18n.translations.en.layers.name["__Florida"] = "Homestead Sectors";
    mro_Map.addLayer(raid_mapLayer);
    raid_mapLayer.setVisibility(true);
    




var VHomestd1 =[{lon:'-80.52',lat:'25.54'},{lon:'-80.4986',lat:'25.54'},{lon:'-80.4986',lat:'25.52'},{lon:'-80.52',lat:'25.52'}];     
AddRaidPolygon(raid_mapLayer, VHomestd1,"#","HS 1");                                                                                  
var VHomestd2 =[{lon:'-80.4986',lat:'25.54'},{lon:'-80.4771',lat:'25.54'},{lon:'-80.4771',lat:'25.52'},{lon:'-80.4986',lat:'25.52'}]; 
AddRaidPolygon(raid_mapLayer, VHomestd2,"#","HS 2");                                                                                  
var VHomestd3 =[{lon:'-80.4771',lat:'25.54'},{lon:'-80.4557',lat:'25.54'},{lon:'-80.4557',lat:'25.52'},{lon:'-80.4771',lat:'25.52'}]; 
AddRaidPolygon(raid_mapLayer, VHomestd3,"#","HS 3");                                                                                  
var VHomestd4 =[{lon:'-80.4557',lat:'25.54'},{lon:'-80.4343',lat:'25.54'},{lon:'-80.4343',lat:'25.52'},{lon:'-80.4557',lat:'25.52'}]; 
AddRaidPolygon(raid_mapLayer, VHomestd4,"#","HS 4");                                                                                  
var VHomestd5 =[{lon:'-80.4343',lat:'25.54'},{lon:'-80.4129',lat:'25.54'},{lon:'-80.4129',lat:'25.52'},{lon:'-80.4343',lat:'25.52'}]; 
AddRaidPolygon(raid_mapLayer, VHomestd5,"#","HS 5");                                                                                  
var VHomestd6 =[{lon:'-80.4129',lat:'25.54'},{lon:'-80.3914',lat:'25.54'},{lon:'-80.3914',lat:'25.52'},{lon:'-80.4129',lat:'25.52'}]; 
AddRaidPolygon(raid_mapLayer, VHomestd6,"#","HS 6");                                                                                  
var VHomestd7 =[{lon:'-80.3914',lat:'25.54'},{lon:'-80.37',lat:'25.54'},{lon:'-80.37',lat:'25.52'},{lon:'-80.3914',lat:'25.52'}];     
AddRaidPolygon(raid_mapLayer, VHomestd7,"#","HS 7");                                                                                  
var VHomestd8 =[{lon:'-80.52',lat:'25.52'},{lon:'-80.4986',lat:'25.52'},{lon:'-80.4986',lat:'25.5'},{lon:'-80.52',lat:'25.5'}];       
AddRaidPolygon(raid_mapLayer, VHomestd8,"#","HS 8");                                                                                  
var VHomestd9 =[{lon:'-80.4986',lat:'25.52'},{lon:'-80.4771',lat:'25.52'},{lon:'-80.4771',lat:'25.5'},{lon:'-80.4986',lat:'25.5'}];   
AddRaidPolygon(raid_mapLayer, VHomestd9,"#","HS 9");                                                                                  
var VHomestd10 =[{lon:'-80.4771',lat:'25.52'},{lon:'-80.4557',lat:'25.52'},{lon:'-80.4557',lat:'25.5'},{lon:'-80.4771',lat:'25.5'}];  
AddRaidPolygon(raid_mapLayer, VHomestd10,"#","HS 10");                                                                                
var VHomestd11 =[{lon:'-80.4557',lat:'25.52'},{lon:'-80.4343',lat:'25.52'},{lon:'-80.4343',lat:'25.5'},{lon:'-80.4557',lat:'25.5'}];  
AddRaidPolygon(raid_mapLayer, VHomestd11,"#","HS 11");                                                                                
var VHomestd12 =[{lon:'-80.4343',lat:'25.52'},{lon:'-80.4129',lat:'25.52'},{lon:'-80.4129',lat:'25.5'},{lon:'-80.4343',lat:'25.5'}];  
AddRaidPolygon(raid_mapLayer, VHomestd12,"#","HS 12");                                                                                
var VHomestd13 =[{lon:'-80.4129',lat:'25.52'},{lon:'-80.3914',lat:'25.52'},{lon:'-80.3914',lat:'25.5'},{lon:'-80.4129',lat:'25.5'}];  
AddRaidPolygon(raid_mapLayer, VHomestd13,"#","HS 13");                                                                                
var VHomestd14 =[{lon:'-80.3914',lat:'25.52'},{lon:'-80.37',lat:'25.52'},{lon:'-80.37',lat:'25.5'},{lon:'-80.3914',lat:'25.5'}];      
AddRaidPolygon(raid_mapLayer, VHomestd14,"#","HS 14");                                                                                
var VHomestd15 =[{lon:'-80.52',lat:'25.5'},{lon:'-80.4986',lat:'25.5'},{lon:'-80.4986',lat:'25.48'},{lon:'-80.52',lat:'25.48'}];      
AddRaidPolygon(raid_mapLayer, VHomestd15,"#","HS 15");                                                                                
var VHomestd16 =[{lon:'-80.4986',lat:'25.5'},{lon:'-80.4771',lat:'25.5'},{lon:'-80.4771',lat:'25.48'},{lon:'-80.4986',lat:'25.48'}];  
AddRaidPolygon(raid_mapLayer, VHomestd16,"#","HS 16");                                                                                
var VHomestd17 =[{lon:'-80.4771',lat:'25.5'},{lon:'-80.4557',lat:'25.5'},{lon:'-80.4557',lat:'25.48'},{lon:'-80.4771',lat:'25.48'}];  
AddRaidPolygon(raid_mapLayer, VHomestd17,"#","HS 17");                                                                                
var VHomestd18 =[{lon:'-80.4557',lat:'25.5'},{lon:'-80.4343',lat:'25.5'},{lon:'-80.4343',lat:'25.48'},{lon:'-80.4557',lat:'25.48'}];  
AddRaidPolygon(raid_mapLayer, VHomestd18,"#","HS 18");                                                                                
var VHomestd19 =[{lon:'-80.4343',lat:'25.5'},{lon:'-80.4129',lat:'25.5'},{lon:'-80.4129',lat:'25.48'},{lon:'-80.4343',lat:'25.48'}];  
AddRaidPolygon(raid_mapLayer, VHomestd19,"#","HS 19");                                                                                
var VHomestd20 =[{lon:'-80.4129',lat:'25.5'},{lon:'-80.3914',lat:'25.5'},{lon:'-80.3914',lat:'25.48'},{lon:'-80.4129',lat:'25.48'}];  
AddRaidPolygon(raid_mapLayer, VHomestd20,"#","HS 20");                                                                                
var VHomestd21 =[{lon:'-80.3914',lat:'25.5'},{lon:'-80.37',lat:'25.5'},{lon:'-80.37',lat:'25.48'},{lon:'-80.3914',lat:'25.48'}];      
AddRaidPolygon(raid_mapLayer, VHomestd21,"#","HS 21");                                                                                
var VHomestd22 =[{lon:'-80.52',lat:'25.48'},{lon:'-80.4986',lat:'25.48'},{lon:'-80.4986',lat:'25.46'},{lon:'-80.52',lat:'25.46'}];    
AddRaidPolygon(raid_mapLayer, VHomestd22,"#","HS 22");                                                                                
var VHomestd23 =[{lon:'-80.4986',lat:'25.48'},{lon:'-80.4771',lat:'25.48'},{lon:'-80.4771',lat:'25.46'},{lon:'-80.4986',lat:'25.46'}];
AddRaidPolygon(raid_mapLayer, VHomestd23,"#","HS 23");                                                                                
var VHomestd24 =[{lon:'-80.4771',lat:'25.48'},{lon:'-80.4557',lat:'25.48'},{lon:'-80.4557',lat:'25.46'},{lon:'-80.4771',lat:'25.46'}];
AddRaidPolygon(raid_mapLayer, VHomestd24,"#","HS 24");                                                                                
var VHomestd25 =[{lon:'-80.4557',lat:'25.48'},{lon:'-80.4343',lat:'25.48'},{lon:'-80.4343',lat:'25.46'},{lon:'-80.4557',lat:'25.46'}];
AddRaidPolygon(raid_mapLayer, VHomestd25,"#","HS 25");                                                                                
var VHomestd26 =[{lon:'-80.4343',lat:'25.48'},{lon:'-80.4129',lat:'25.48'},{lon:'-80.4129',lat:'25.46'},{lon:'-80.4343',lat:'25.46'}];
AddRaidPolygon(raid_mapLayer, VHomestd26,"#","HS 26");                                                                                
var VHomestd27 =[{lon:'-80.4129',lat:'25.48'},{lon:'-80.3914',lat:'25.48'},{lon:'-80.3914',lat:'25.46'},{lon:'-80.4129',lat:'25.46'}];
AddRaidPolygon(raid_mapLayer, VHomestd27,"#","HS 27");                                                                                
var VHomestd28 =[{lon:'-80.3914',lat:'25.48'},{lon:'-80.37',lat:'25.48'},{lon:'-80.37',lat:'25.46'},{lon:'-80.3914',lat:'25.46'}];    
AddRaidPolygon(raid_mapLayer, VHomestd28,"#","HS 28");                                                                                
var VHomestd29 =[{lon:'-80.52',lat:'25.46'},{lon:'-80.4986',lat:'25.46'},{lon:'-80.4986',lat:'25.44'},{lon:'-80.52',lat:'25.44'}];    
AddRaidPolygon(raid_mapLayer, VHomestd29,"#","HS 29");                                                                                
var VHomestd30 =[{lon:'-80.4986',lat:'25.46'},{lon:'-80.4771',lat:'25.46'},{lon:'-80.4771',lat:'25.44'},{lon:'-80.4986',lat:'25.44'}];
AddRaidPolygon(raid_mapLayer, VHomestd30,"#","HS 30");                                                                                
var VHomestd31 =[{lon:'-80.4771',lat:'25.46'},{lon:'-80.4557',lat:'25.46'},{lon:'-80.4557',lat:'25.44'},{lon:'-80.4771',lat:'25.44'}];
AddRaidPolygon(raid_mapLayer, VHomestd31,"#","HS 31");                                                                                
var VHomestd32 =[{lon:'-80.4557',lat:'25.46'},{lon:'-80.4343',lat:'25.46'},{lon:'-80.4343',lat:'25.44'},{lon:'-80.4557',lat:'25.44'}];
AddRaidPolygon(raid_mapLayer, VHomestd32,"#","HS 32");                                                                                
var VHomestd33 =[{lon:'-80.4343',lat:'25.46'},{lon:'-80.4129',lat:'25.46'},{lon:'-80.4129',lat:'25.44'},{lon:'-80.4343',lat:'25.44'}];
AddRaidPolygon(raid_mapLayer, VHomestd33,"#","HS 33");                                                                                
var VHomestd34 =[{lon:'-80.4129',lat:'25.46'},{lon:'-80.3914',lat:'25.46'},{lon:'-80.3914',lat:'25.44'},{lon:'-80.4129',lat:'25.44'}];
AddRaidPolygon(raid_mapLayer, VHomestd34,"#","HS 34");                                                                                
var VHomestd35 =[{lon:'-80.3914',lat:'25.46'},{lon:'-80.37',lat:'25.46'},{lon:'-80.37',lat:'25.44'},{lon:'-80.3914',lat:'25.44'}];    
AddRaidPolygon(raid_mapLayer, VHomestd35,"#","HS 35");                                                                                
var VHomestd36 =[{lon:'-80.52',lat:'25.44'},{lon:'-80.4986',lat:'25.44'},{lon:'-80.4986',lat:'25.42'},{lon:'-80.52',lat:'25.42'}];    
AddRaidPolygon(raid_mapLayer, VHomestd36,"#","HS 36");                                                                                
var VHomestd37 =[{lon:'-80.4986',lat:'25.44'},{lon:'-80.4771',lat:'25.44'},{lon:'-80.4771',lat:'25.42'},{lon:'-80.4986',lat:'25.42'}];
AddRaidPolygon(raid_mapLayer, VHomestd37,"#","HS 37");                                                                                
var VHomestd38 =[{lon:'-80.4771',lat:'25.44'},{lon:'-80.4557',lat:'25.44'},{lon:'-80.4557',lat:'25.42'},{lon:'-80.4771',lat:'25.42'}];
AddRaidPolygon(raid_mapLayer, VHomestd38,"#","HS 38");                                                                                
var VHomestd39 =[{lon:'-80.4557',lat:'25.44'},{lon:'-80.4343',lat:'25.44'},{lon:'-80.4343',lat:'25.42'},{lon:'-80.4557',lat:'25.42'}];
AddRaidPolygon(raid_mapLayer, VHomestd39,"#","HS 39");                                                                                
var VHomestd40 =[{lon:'-80.4343',lat:'25.44'},{lon:'-80.4129',lat:'25.44'},{lon:'-80.4129',lat:'25.42'},{lon:'-80.4343',lat:'25.42'}];
AddRaidPolygon(raid_mapLayer, VHomestd40,"#","HS 40");                                                                                
var VHomestd41 =[{lon:'-80.4129',lat:'25.44'},{lon:'-80.3914',lat:'25.44'},{lon:'-80.3914',lat:'25.42'},{lon:'-80.4129',lat:'25.42'}];
AddRaidPolygon(raid_mapLayer, VHomestd41,"#","HS 41");                                                                                
var VHomestd42 =[{lon:'-80.3914',lat:'25.44'},{lon:'-80.37',lat:'25.44'},{lon:'-80.37',lat:'25.42'},{lon:'-80.3914',lat:'25.42'}];    
AddRaidPolygon(raid_mapLayer, VHomestd42,"#","HS 42");                                                                                
var VHomestd43 =[{lon:'-80.52',lat:'25.42'},{lon:'-80.4986',lat:'25.42'},{lon:'-80.4986',lat:'25.4'},{lon:'-80.52',lat:'25.4'}];      
AddRaidPolygon(raid_mapLayer, VHomestd43,"#","HS 43");                                                                                
var VHomestd44 =[{lon:'-80.4986',lat:'25.42'},{lon:'-80.4771',lat:'25.42'},{lon:'-80.4771',lat:'25.4'},{lon:'-80.4986',lat:'25.4'}];  
AddRaidPolygon(raid_mapLayer, VHomestd44,"#","HS 44");                                                                                
var VHomestd45 =[{lon:'-80.4771',lat:'25.42'},{lon:'-80.4557',lat:'25.42'},{lon:'-80.4557',lat:'25.4'},{lon:'-80.4771',lat:'25.4'}];  
AddRaidPolygon(raid_mapLayer, VHomestd45,"#","HS 45");                                                                                
var VHomestd46 =[{lon:'-80.4557',lat:'25.42'},{lon:'-80.4343',lat:'25.42'},{lon:'-80.4343',lat:'25.4'},{lon:'-80.4557',lat:'25.4'}];  
AddRaidPolygon(raid_mapLayer, VHomestd46,"#","HS 46");                                                                                
var VHomestd47 =[{lon:'-80.4343',lat:'25.42'},{lon:'-80.4129',lat:'25.42'},{lon:'-80.4129',lat:'25.4'},{lon:'-80.4343',lat:'25.4'}];  
AddRaidPolygon(raid_mapLayer, VHomestd47,"#","HS 47");                                                                                
var VHomestd48 =[{lon:'-80.4129',lat:'25.42'},{lon:'-80.3914',lat:'25.42'},{lon:'-80.3914',lat:'25.4'},{lon:'-80.4129',lat:'25.4'}];  
AddRaidPolygon(raid_mapLayer, VHomestd48,"#","HS 48");                                                                                
var VHomestd49 =[{lon:'-80.3914',lat:'25.42'},{lon:'-80.37',lat:'25.42'},{lon:'-80.37',lat:'25.4'},{lon:'-80.3914',lat:'25.4'}];      
AddRaidPolygon(raid_mapLayer, VHomestd49,"#","HS 49");                                                                                
                                                                             
                                                                                   



//test
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
//generateholes(mro_Map, raid_mapLayer);



    
	
    setTimeout(function(){CurrentRaidLocation(raid_mapLayer);},3000);
    mro_Map.events.register("moveend", Waze.map, function(){CurrentRaidLocation(raid_mapLayer);});
    mro_Map.events.register("zoomend", Waze.map, function(){CurrentRaidLocation(raid_mapLayer);});
       
}

bootstrap_MapRaidOverlay(); 
